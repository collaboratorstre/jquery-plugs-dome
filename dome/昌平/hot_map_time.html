<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>hotMaptime</title>
	<link rel="stylesheet" href="http://cdn.staticfile.org/twitter-bootstrap/3.0.1/css/bootstrap.min.css">
	<link rel="stylesheet" href="css/hotmap.css">
	<script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/DatePicker/WdatePicker.js"></script>
</head>
<body>
	<div class="mapbox" style="position: relative;">
	<!-- 	<div class="map_btn" style="position: absolute; z-index: 1000;">
			<button type="button" class="btn btn-warning">星期六</button>

			<button type="button" class="btn btn-success">星期日</button>
		</div> -->
		<div class="time_select" style="position: absolute; z-index: 1000; width: 200px;background: white;bottom: 12%;left: 30.8%;opacity: 0.9;height: 129px; display: none;">
				      			<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox0" value="0"> 0
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox1" value="1"> 1
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox2" value="2"> 2
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox3" value="3"> 3
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox4" value="4"> 4
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox5" value="5"> 5
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox6" value="6"> 6
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox7" value="7"> 7
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox8" value="8"> 8
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox9" value="9"> 9
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox10" value="10"> 10
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox11" value="11"> 11
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox12" value="12"> 12
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox13" value="13"> 13
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox14" value="14"> 14
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox15" value="15"> 15
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox16" value="16"> 16
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox17" value="17"> 17
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox18" value="18"> 18
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox19" value="19"> 19
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox20" value="20"> 20
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox21" value="21"> 21
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox22" value="22"> 22
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox23" value="23"> 23
								</label>
									<div class="map_btn" style="position: absolute; z-index: 1000;margin-left: 45%;">
										<button type="button" class="btn btn-default" id="time_cancel">取消</button>

										<button type="button" class="btn btn-default" id="time_sure">确定</button>
									</div>
		</div>
		<div class="content" id="touristDistribution"  style="width: 700px;height: 600px;"></div>
		<div class="row clearfix" style="position: absolute;bottom: 0px;z-index: 1000;width: 52%;">
                <div class="col-md-12 column time_zong">
                    <nav class="navbar navbar-default" role="navigation"  style="background-color: #f5f5f5">

                        <div class="collapse navbar-collapse time_fen" id="bs-example-navbar-collapse-1">
							<div class="navbar-form navbar-left time_duan">时间段:</div>
                            <div class="navbar-form navbar-left time_left"  >

                                <input type="text" class="form-control"   id="time1" onfocus="WdatePicker({isShowClear:true,dateFmt:'yyyy-MM-dd',maxDate:'#F{$dp.$D(\'time1\')}'})"/>
                            </div>
                            <div class="navbar-form navbar-left time_zhong" >
                                <div class="form-group">
                                    -
                                </div>
                            </div>
                            
                            <div class="navbar-form navbar-left time_right" >
                                <input type="text" class="form-control"   id="time2" onfocus="WdatePicker({isShowClear:true,dateFmt:'yyyy-MM-dd',minDate:'#F{$dp.$D(\'time2\')}'})"/>
                            </div>
                            <div class="navbar-form navbar-left time_week" >
								<input type="checkbox" id="weeks">周末
                            </div>
                            <div class="navbar-form navbar-left time_duan">时间点:</div>
                            <div class="navbar-form navbar-left time_times">
							<!-- 	<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox1" value="option1"> 1
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox2" value="option2"> 2
								</label>
								<label class="checkbox-inline">
								  <input type="checkbox" id="inlineCheckbox3" value="option3"> 3
								</label> -->
								<input type="text" class="form-control" id="time_chuli">
                            </div>
							<div class="navbar-form navbar-left time_duan">点:</div>
							<div class="navbar-form navbar-left num_dian">
								<input type="text" class="form-control" id="nums">	
							</div>
                            <div class="navbar-form navbar-right time_sou">
                                <input type="hidden" name="img" id="img" />
                                <input type="hidden" name="dataText" id="dataText" />
                                <button type="button" class="btn btn-primary"     onclick="search()">搜索</button>
                            </div>
                        </div>

                    </nav>
                </div>
          
	         </div>
	    </div>     
	</div>
	

	<script type="text/javascript"
            src="http://webapi.amap.com/maps?v=1.3&key=a67bab9e2c29241c092fde49544cd428"></script>
    <script type="text/javascript" src="js/hotmap.js"></script>       
	<script type="text/javascript">
			
		    var touristDistribution = function(data){
		    			console.log(data);

		    			var res = [];
		    			for(var i = 0;i<data.length;i++){
		    				res.push({
		    					lng:data[i].lon,
		    					lat:data[i].lat,
		    					count: data[i].frequency
		    				})
		    			}
		    			console.log(res);

		    			 var map = new AMap.Map('touristDistribution', {
					        resizeEnable: true,
					        zoom:10,
					        center: [116.20, 40.22],
					        // mapStyle:'amap://styles/9520d22f7b2eb0a9dee2d26724da5f94'
					        //前往创建自定义地图样式：http://lbs.amap.com/dev/mapstyle/index
					        mapStyle: 'amap://styles/f55432c290d8017cf821fd7479bf3962'
					        // mapStyle: 'amap://styles/dark'
					    });
					    // 加载行政区划插件
				    AMap.service('AMap.DistrictSearch', function() {
				        var opts = {
				            subdistrict: 1,   // 返回下一级行政区
				            extensions: 'all',  // 返回行政区边界坐标组等具体信息
				            level: 'city'  // 查询行政级别为 市
				        };
				        // 实例化DistrictSearch
				        district = new AMap.DistrictSearch(opts);
				        district.setLevel('district');
				        // 行政区查询
				        district.search('昌平区', function(status, result) {
				            var bounds = result.districtList[0].boundaries;
				            var polygons = [];
				            if (bounds) {
				                for (var i = 0, l = bounds.length; i < l; i++) {
				                    // 生成行政区划polygon
				                    var polygon = new AMap.Polygon({
				                        map: map,
				                        strokeWeight: 2,
				                        path: bounds[i],
				                        fillOpacity: 0.3,
				                        strokeWeight: 5,
				                        shadowOffsetX: 4,
				                        shadowOffsetY: 4,
				                        shadowBlur: 5,
				                        shadowColor: '#26e7e7',
				                        fillColor: 'rgba(200, 54, 54, 0.3)',
				                        strokeColor: '#09f6ee'
				                    });
				                    polygons.push(polygon);
				                }
				                map.setFitView();// 地图自适应
				                map.setZoomAndCenter(9, [116.23,40.22]);
				            }
				        });

				    });
				    //实时路况图层
				    var trafficLayer = new AMap.TileLayer.Traffic({
				        zIndex: 10
				    });
				    trafficLayer.setMap(map);
				    trafficLayer.show();

				        var heatmap;
					    map.plugin(["AMap.Heatmap"], function() {
					        //初始化heatmap对象
					        heatmap = new AMap.Heatmap(map, {
					            radius: 25, //给定半径
					            opacity: [0, 0.8]
					            /*,gradient:{
					             0.5: 'blue',
					             0.65: 'rgb(117,211,248)',
					             0.7: 'rgb(0, 255, 0)',
					             0.9: '#ffea00',
					             1.0: 'red'
					             }*/
					        });
					        //设置数据集：该数据为北京部分“公园”数据
					        heatmap.setDataSet({
					            data: res,
					            max: 100
					        });
					    });

		    }

		     //数据的统一请求
     var refreshData = function(){
          $.get("../json/hotmaptime.json",function(data){
          	touristDistribution(data.scenicGeoInfo);
          })
      }

        $(document).ready(function(){
    	          refreshData();
		       })  
	</script>
</body>
</html>